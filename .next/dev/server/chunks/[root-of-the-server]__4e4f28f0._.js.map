{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/job/meowcat/app/api/chat/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { from, of } from \"rxjs\";\r\nimport { concatMap, delay, map } from \"rxjs/operators\";\r\n\r\nconst MESSAGES = `ÂçßÊßΩÔºåËøòÁúüÊå∫ÊúâÊïàÊûúÁöÑÂì¶„ÄÇÂ§úÈòëÂçßÂê¨È£éÂêπÈõ®ÔºåÈìÅÈ©¨ÂÜ∞Ê≤≥ÂÖ•Ê¢¶Êù•„ÄÇ‰∏úÈ£éÂ§úÊîæËä±ÂçÉÊ†ëÔºåÊõ¥ÂêπËêΩÔºåÊòüÂ¶ÇÈõ®„ÄÇÂÆùÈ©¨ÈõïËΩ¶È¶ôÊª°Ë∑Ø„ÄÇÂá§ÁÆ´Â£∞Âä®ÔºåÁéâÂ£∂ÂÖâËΩ¨Ôºå‰∏ÄÂ§úÈ±ºÈæôËàû„ÄÇËõæÂÑøÈõ™Êü≥ÈªÑÈáëÁºïÔºåÁ¨ëËØ≠ÁõàÁõàÊöóÈ¶ôÂéª„ÄÇ‰ºóÈáåÂØª‰ªñÂçÉÁôæÂ∫¶ÔºåËì¶ÁÑ∂ÂõûÈ¶ñÔºåÈÇ£‰∫∫Âç¥Âú®ÔºåÁÅØÁÅ´ÈòëÁèäÂ§Ñ„ÄÇ`;\r\n\r\nexport async function POST(req: Request) {\r\n  const encoder = new TextEncoder();\r\n\r\n  const stream = new ReadableStream({\r\n    async start(controller) {\r\n      const chars = Array.from(MESSAGES);\r\n\r\n      const subscription = from(chars)\r\n        .pipe(\r\n          concatMap((char) => of(char).pipe(delay(30 + Math.random() * 50))),\r\n\r\n          map((char) => {\r\n            return `data: ${JSON.stringify({ content: char })}\\n\\n`;\r\n          }),\r\n        )\r\n        .subscribe({\r\n          next: (encodedChunk) => {\r\n            try {\r\n              controller.enqueue(encoder.encode(encodedChunk));\r\n            } catch (error) {\r\n              // Â¶ÇÊûúÊä•ÈîôÔºåËØ¥ÊòéÊµÅÂ∑≤ÁªèÂÖ≥Èó≠‰∫ÜÔºåËµ∂Á¥ßÂèñÊ∂àËÆ¢ÈòÖÔºåÂà´Êé®‰∫Ü\r\n              subscription.unsubscribe();\r\n            }\r\n          },\r\n          complete: () => {\r\n            // üõ°Ô∏è Èò≤Âæ°Êé™ÊñΩ 2ÔºöÂÖ≥Èó≠ÂâçÔºåËØïËØïÁúãËÉΩ‰∏çËÉΩÂÖ≥\r\n            try {\r\n              controller.close();\r\n            } catch (error) {\r\n              // Â¶ÇÊûúÊä•ÈîôËØ¥ÊòéÂ∑≤ÁªèÂÖ≥‰∫ÜÔºåÈÇ£Â∞±Êó†ÊâÄË∞ì‰∫ÜÔºåÂøΩÁï•ÂÆÉ\r\n            }\r\n          },\r\n          error: (err) => {\r\n            console.error(\"RxJS Stream Error:\", err);\r\n            try {\r\n              controller.error(err);\r\n            } catch (error) {\r\n              // Âêå‰∏äÔºåÂøΩÁï•\r\n            }\r\n          },\r\n        });\r\n      req.signal.addEventListener(\"abort\", () => {\r\n        subscription.unsubscribe();\r\n      });\r\n\r\n      return new NextResponse(stream, {\r\n        headers: {\r\n          \"Content-Type\": \"text/event-stream\", // ÂøÖÈ°ªÂ£∞ÊòéÊòØ‰∫ã‰ª∂ÊµÅ\r\n          \"Cache-Control\": \"no-cache\",\r\n          Connection: \"keep-alive\",\r\n        },\r\n      });\r\n    },\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,WAAW,CAAC,4GAA4G,CAAC;AAExH,eAAe,KAAK,GAAY;IACrC,MAAM,UAAU,IAAI;IAEpB,MAAM,SAAS,IAAI,eAAe;QAChC,MAAM,OAAM,UAAU;YACpB,MAAM,QAAQ,MAAM,IAAI,CAAC;YAEzB,MAAM,eAAe,IAAA,uMAAI,EAAC,OACvB,IAAI,CACH,IAAA,yNAAS,EAAC,CAAC,OAAS,IAAA,qMAAE,EAAC,MAAM,IAAI,CAAC,IAAA,qNAAK,EAAC,KAAK,KAAK,MAAM,KAAK,OAE7D,IAAA,mNAAG,EAAC,CAAC;gBACH,OAAO,CAAC,MAAM,EAAE,KAAK,SAAS,CAAC;oBAAE,SAAS;gBAAK,GAAG,IAAI,CAAC;YACzD,IAED,SAAS,CAAC;gBACT,MAAM,CAAC;oBACL,IAAI;wBACF,WAAW,OAAO,CAAC,QAAQ,MAAM,CAAC;oBACpC,EAAE,OAAO,OAAO;wBACd,2BAA2B;wBAC3B,aAAa,WAAW;oBAC1B;gBACF;gBACA,UAAU;oBACR,yBAAyB;oBACzB,IAAI;wBACF,WAAW,KAAK;oBAClB,EAAE,OAAO,OAAO;oBACd,wBAAwB;oBAC1B;gBACF;gBACA,OAAO,CAAC;oBACN,QAAQ,KAAK,CAAC,sBAAsB;oBACpC,IAAI;wBACF,WAAW,KAAK,CAAC;oBACnB,EAAE,OAAO,OAAO;oBACd,QAAQ;oBACV;gBACF;YACF;YACF,IAAI,MAAM,CAAC,gBAAgB,CAAC,SAAS;gBACnC,aAAa,WAAW;YAC1B;YAEA,OAAO,IAAI,+PAAY,CAAC,QAAQ;gBAC9B,SAAS;oBACP,gBAAgB;oBAChB,iBAAiB;oBACjB,YAAY;gBACd;YACF;QACF;IACF;AACF","debugId":null}}]
}